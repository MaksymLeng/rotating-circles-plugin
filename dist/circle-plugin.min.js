var r=class{constructor(e,t=[],s={}){this.container=document.getElementById(e),this.books=t,this.config={radius:s.radius||150,speed:s.speed||.01,mode:s.mode||"circular",maxFps:s.maxFps||60,randomSpeedRange:s.randomSpeedRange||[.5,2]},this.parentAngle=0,this.isPaused=!1,this.circlesData=[],this.lastFrameTime=0,this.config.mode==="random"&&this.container.classList.add("random-mode"),this.init()}init(){this.books.forEach(e=>this.addBookCircle(e)),this.animate()}addBook(e){this.books.push(e),this.addBookCircle(e)}addBookCircle(e){let t=document.createElement("div");t.classList.add("book-circle",e.status);let s=e.status==="read"?"\u2705":e.status==="reading"?"\u{1F4D6}":"\u{1F4CC}";t.innerHTML=`
            <div class="book-content">
                <span class="book-icon">${s}</span>
                <span class="book-title">${e.title[0].toUpperCase()}</span>
                <div class="book-details">
                    <p>Autor: ${e.author}</p>
                    <p>Title: ${e.title}</p>
                    <p>Genre: ${e.genre||"_"}</p>
                </div>
            </div>
        `,t.addEventListener("click",async()=>{if(t.classList.contains("expanded")){if(e.fileName){let i=new CustomEvent("book-open-requested",{detail:{fileName:e.fileName,book:e}});window.dispatchEvent(i)}}else t.classList.add("expanded"),this.isPaused=!0}),document.addEventListener("click",i=>{i.target.closest(".book-circle")||(this.isPaused=!1,t.classList.remove("expanded"),this.container.querySelectorAll(".book-circle.expanded").forEach(n=>{n.classList.remove("expanded")}))}),this.container.appendChild(t),this.config.mode==="random"&&this.initRandomData(),this.updatePositions()}updatePositions(){this.config.mode==="circular"?this.updateCircularPosition():this.updateRandomPosition()}setMode(e){this.config.mode=e,e==="random"?(this.container.classList.add("random-mode"),this.initRandomData()):this.container.classList.remove("random-mode"),this.updatePositions()}updateCircularPosition(){let e=this.container.querySelectorAll(".book-circle"),t=e.length,s=this.config.radius;e.forEach((i,a)=>{let o=2*Math.PI/t*a+this.parentAngle,c=200,d=200,h=c+s*Math.cos(o),m=d+s*Math.sin(o);i.style.left=`${h}px`,i.style.top=`${m}px`;let l=i.querySelector(".book-content"),p=o*180/Math.PI;i.classList.contains("expanded")?l.style.transform="rotate(0deg)":l.style.transform=`rotate(${-p+180}deg)`})}initRandomData(){this.circlesData=[];let e=this.container.getBoundingClientRect();this.container.querySelectorAll(".book-circle").forEach(s=>{let i=Math.random()*e.width,a=Math.random()*e.height,[n,o]=this.config.randomSpeedRange,c=(Math.random()*(o-n)+n)*(Math.random()<.5?-1:1),d=(Math.random()*(o-n)+n)*(Math.random()<.5?-1:1);this.circlesData.push({element:s,x:i,y:a,vx:c,vy:d}),s.style.left=`${i}px`,s.style.top=`${a}px`})}updateRandomPosition(){let e=this.container.getBoundingClientRect();this.circlesData.forEach(t=>{this.isPaused||(t.x+=t.vx,t.y+=t.vy,t.x<0&&(t.x=0,t.vx*=-1),t.x>e.width&&(t.x=e.width,t.vx*=-1),t.y<0&&(t.y=0,t.vy*=-1),t.y>e.height&&(t.y=e.height,t.vy*=-1)),t.element.style.left=`${t.x}px`,t.element.style.top=`${t.y}px`})}animate(e){if(e-this.lastFrameTime<1e3/this.config.maxFps){requestAnimationFrame(this.animate.bind(this));return}this.lastFrameTime=e,this.config.mode==="circular"&&!this.isPaused&&(this.parentAngle+=this.config.speed),this.updatePositions(),requestAnimationFrame(this.animate.bind(this))}};export{r as default};
